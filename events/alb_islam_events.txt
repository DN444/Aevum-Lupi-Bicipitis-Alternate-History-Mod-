namespace = alb_islam_events

country_event = {
	id = alb_islam_events.1
	title = alb_islam_events.1.test
	desc = alb_islam_events.1.desc
	picture = muslimgfx_REFORM_eventPicture
	
	trigger = {
		is_year = 1520
		REB = {
			NOT = {
				check_variable = {
					which = caliph_authority_var
					value = 50
				}
			}
		}
		any_owned_province = {
			region = arabia_region
			culture_group = turko_semitic
			religion = islam
		}
	}
	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.2
			tag = event_target:islam_caliph_target
		}
	}
	fire_only_once = yes
	option = {
		name = alb_islam_events.1a
		random_owned_province = {
			limit = {
				region = arabia_region
				culture_group = turko_semitic
				religion = islam
			}
			add_permanent_province_modifier = {
				name = jafar_al_rashidi_activity
				duration = -1
			}
		}
		set_global_flag = jafar_al_rashid_preaching
	}
	option = {
		name = alb_islam_events.1b
		trigger = {
			NOT = {
				tag = event_target:islam_caliph_target
			}
		}
		random_owned_province = {
			limit = {
				region = arabia_region
				culture_group = turko_semitic
				religion = islam
			}
			add_permanent_province_modifier = {
				name = jafar_al_rashidi_activity
				duration = -1
			}
		}
		add_country_modifier = {
			name = accepting_to_rashidis_modifier
			duration = -1
		}
		set_global_flag = jafar_al_rashid_preaching
	}
}

#Rashidi community established itself
country_event = {
	id = alb_islam_events.2
	title = alb_islam_events.2.test
	desc = alb_islam_events.2.desc
	picture = muslimgfx_REFORM_eventPicture
	
	trigger = {
		has_global_flag = jafar_al_rashid_preaching
		any_owned_province = {
			NOT = {
				has_province_modifier = rashidi_community_in_province
			}
			region = arabia_region
			culture_group = turko_semitic
			religion = islam
		}
		NOT = {
			calc_true_if = {
				amount = 31
				all_province = {
					has_province_modifier = rashidi_community_in_province
				}
			}
		}
	}
	mean_time_to_happen = {
		months = 600
		modifier = {
			factor = 0.9
			has_country_modifier = accepting_to_rashidis_modifier
		}
		modifier = {
			factor = 0.75
			any_neighbor_province = {
				OR = {
					has_province_modifier = rashidi_community_in_province
					has_province_modifier = jafar_al_rashidi_activity
				}
			}
		}
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					NOT = {
						has_province_modifier = rashidi_community_in_province
					}
					region = arabia_region
					culture_group = turko_semitic
				}
				save_event_target_as = rashidi_community_province
			}
		}
	}
	option = {
		name = alb_islam_events.2a
		event_target:rashidi_community_province = {
			add_permanent_province_modifier = {
				name = rashidi_community_in_province
				duration = -1
			}
		}
	}
	option = {
		name = alb_islam_events.2b
		event_target:rashidi_community_province = {
			add_permanent_province_modifier = {
				name = rashidi_community_in_province
				duration = -1
			}
		}
		add_country_modifier = {
			name = accepting_to_rashidis_modifier
			duration = -1
		}
	}
}